// Generated by CoffeeScript 1.6.3
var app, contributor, express;

contributor = require('./contributor');

express = require('express');

app = express();

app.use(express.logger());

app.get('/api', function(req, res) {
  var error, identities, param, platform, success, _i, _len, _ref;
  identities = {};
  success = function(counts) {
    return res.send(counts);
  };
  error = function(counts) {
    return res.send(404);
  };
  _ref = contributor.support;
  for (_i = 0, _len = _ref.length; _i < _len; _i++) {
    platform = _ref[_i];
    param = req.query[platform];
    if (param) {
      identities[platform] = param;
    }
  }
  return contributor(identities).then(success, error);
});

exports.app = app;
